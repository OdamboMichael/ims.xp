{% extends 'base.html' %}
{% load static %}

{% block title %}Profile Settings - Xpert Farmer IMS{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <!-- Sidebar Navigation 
        <div class="col-md-3 col-lg-2 d-md-block sidebar">
            <div class="position-sticky pt-3">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'dashboard:home' %}">
                            <i class="fas fa-tachometer-alt me-2"></i>Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'dashboard:users_list' %}">
                            <i class="fas fa-users me-2"></i>Users
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="{% url 'dashboard:settings_account' %}">
                            <i class="fas fa-cog me-2"></i>Settings
                        </a>
                    </li>
                </ul>-->
                
                <!-- Settings Submenu -->
                <div class="mt-4">
                    <h6 class="sidebar-heading px-3 mb-2">Settings</h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'dashboard:settings_account' %}">
                                <i class="fas fa-user-cog me-2"></i>Account
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="{% url 'dashboard:settings_profile' %}">
                                <i class="fas fa-user me-2"></i>Profile
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'dashboard:settings_institution' %}">
                                <i class="fas fa-building me-2"></i>Institution
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'dashboard:settings_general' %}">
                                <i class="fas fa-sliders-h me-2"></i>General
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                <h1 class="h2">Profile Management</h1>
                <div class="btn-toolbar mb-2 mb-md-0">
                    <button type="button" class="btn btn-sm btn-outline-secondary" onclick="window.print()">
                        <i class="fas fa-print me-1"></i>Print Profile
                    </button>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-8">
                    <!-- Profile Information Card -->
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5 class="mb-0">Edit Personal Information</h5>
                        </div>
                        <div class="card-body">
                            <form id="profileForm">
                                <div class="text-center mb-4">
                                    <div class="position-relative d-inline-block">
                                        <div class="avatar avatar-xxl">
                                            <img src="{% static 'images/default-avatar.png' %}" alt="Profile" class="rounded-circle" id="profileImage" style="width: 120px; height: 120px; object-fit: cover;">
                                        </div>
                                        <button type="button" class="btn btn-sm btn-primary rounded-pill position-absolute bottom-0 end-0" onclick="document.getElementById('uploadImage').click()">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <input type="file" id="uploadImage" accept="image/*" style="display: none;" onchange="previewImage(this)">
                                    </div>
                                    <div class="mt-2">
                                        <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeProfileImage()">
                                            <i class="fas fa-trash me-1"></i>Remove Photo
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Full Name *</label>
                                        <input type="text" class="form-control" value="John Doe" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Job Title *</label>
                                        <input type="text" class="form-control" value="Data Analyst" required>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Bio / Description</label>
                                    <textarea class="form-control" rows="3" placeholder="Tell us about yourself...">Experienced agricultural data analyst with 10+ years in farm management systems. Specialized in yield optimization and data-driven decision making.</textarea>
                                </div>
                                
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Phone Number</label>
                                        <input type="tel" class="form-control" value="+1 (555) 123-4567">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Department</label>
                                        <input type="text" class="form-control" value="Data Analytics">
                                    </div>
                                </div>
                                
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Location</label>
                                        <input type="text" class="form-control" value="New York, USA">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Time Zone</label>
                                        <select class="form-select">
                                            <option value="EST" selected>Eastern Time (ET)</option>
                                            <option value="CST">Central Time (CT)</option>
                                            <option value="MST">Mountain Time (MT)</option>
                                            <option value="PST">Pacific Time (PT)</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Social Links</label>
                                    <div class="input-group mb-2">
                                        <span class="input-group-text">
                                            <i class="fab fa-linkedin"></i>
                                        </span>
                                        <input type="url" class="form-control" placeholder="LinkedIn Profile URL" value="https://linkedin.com/in/johndoe">
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-text">
                                            <i class="fab fa-twitter"></i>
                                        </span>
                                        <input type="url" class="form-control" placeholder="Twitter Profile URL" value="https://twitter.com/johndoe">
                                    </div>
                                </div>
                                
                                <div class="d-flex justify-content-between">
                                    <button type="button" class="btn btn-secondary" onclick="resetProfileForm()">
                                        Reset
                                    </button>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save me-1"></i>Save Profile
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- Professional Details Card -->
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">Professional Details</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Years of Experience</label>
                                        <input type="number" class="form-control" value="10" min="0" max="50">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Areas of Expertise</label>
                                        <select class="form-select" multiple>
                                            <option selected>Data Analysis</option>
                                            <option selected>Farm Management</option>
                                            <option>Yield Optimization</option>
                                            <option>Precision Agriculture</option>
                                            <option>Sustainable Farming</option>
                                        </select>
                                        <div class="form-text">Hold Ctrl/Cmd to select multiple</div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Education Level</label>
                                        <select class="form-select">
                                            <option value="">Select Education</option>
                                            <option value="highschool">High School</option>
                                            <option value="bachelors" selected>Bachelor's Degree</option>
                                            <option value="masters">Master's Degree</option>
                                            <option value="phd">PhD</option>
                                            <option value="other">Other</option>
                                        </select>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Certifications</label>
                                        <textarea class="form-control" rows="3" placeholder="List your certifications...">Certified Farm Manager (CFM), Data Analytics Professional (DAP)</textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-3">
                                <button class="btn btn-outline-primary" onclick="saveProfessionalDetails()">
                                    <i class="fas fa-briefcase me-1"></i>Save Professional Details
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-4">
                    <!-- Profile Preview Card -->
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5 class="mb-0">Profile Preview</h5>
                        </div>
                        <div class="card-body">
                            <div class="text-center mb-3">
                                <div class="avatar avatar-xl mb-2">
                                    <img src="{% static 'images/default-avatar.png' %}" alt="Profile" class="rounded-circle" style="width: 80px; height: 80px; object-fit: cover;">
                                </div>
                                <h5>John Doe</h5>
                                <p class="text-muted">Data Analyst</p>
                                <p class="small">Global Farming Council</p>
                            </div>
                            
                            <div class="border-top pt-3">
                                <h6>Contact Information</h6>
                                <ul class="list-unstyled small">
                                    <li class="mb-2">
                                        <i class="fas fa-envelope me-2 text-muted"></i>
                                        admin@farmsystem.io
                                    </li>
                                    <li class="mb-2">
                                        <i class="fas fa-phone me-2 text-muted"></i>
                                        +1 (555) 123-4567
                                    </li>
                                    <li class="mb-2">
                                        <i class="fas fa-map-marker-alt me-2 text-muted"></i>
                                        New York, USA
                                    </li>
                                    <li>
                                        <i class="fas fa-clock me-2 text-muted"></i>
                                        Eastern Time (ET)
                                    </li>
                                </ul>
                            </div>
                            
                            <div class="border-top pt-3">
                                <h6>Social Links</h6>
                                <div class="d-flex gap-2">
                                    <a href="#" class="btn btn-sm btn-outline-primary">
                                        <i class="fab fa-linkedin"></i>
                                    </a>
                                    <a href="#" class="btn btn-sm btn-outline-info">
                                        <i class="fab fa-twitter"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Profile Completion Card -->
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5 class="mb-0">Profile Completion</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <div class="d-flex justify-content-between mb-1">
                                    <span>Profile Strength</span>
                                    <span>85%</span>
                                </div>
                                <div class="progress" style="height: 10px;">
                                    <div class="progress-bar bg-success" role="progressbar" style="width: 85%"></div>
                                </div>
                            </div>
                            
                            <div class="small">
                                <p class="mb-2">Complete your profile by adding:</p>
                                <ul class="mb-0">
                                    <li class="text-success">
                                        <i class="fas fa-check-circle me-1"></i>
                                        Profile photo
                                    </li>
                                    <li class="text-success">
                                        <i class="fas fa-check-circle me-1"></i>
                                        Contact information
                                    </li>
                                    <li class="text-warning">
                                        <i class="fas fa-exclamation-circle me-1"></i>
                                        Professional bio
                                    </li>
                                    <li class="text-danger">
                                        <i class="fas fa-times-circle me-1"></i>
                                        Certifications
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Export Profile Card -->
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-file-export me-2"></i>Export Options
                            </h5>
                        </div>
                        <div class="card-body">
                            <p class="small text-muted">Download your profile data in various formats.</p>
                            <div class="d-grid gap-2">
                                <button class="btn btn-outline-primary" onclick="exportProfilePDF()">
                                    <i class="fas fa-file-pdf me-1"></i>Export as PDF
                                </button>
                                <button class="btn btn-outline-success" onclick="exportProfileJSON()">
                                    <i class="fas fa-file-code me-1"></i>Export as JSON
                                </button>
                                <button class="btn btn-outline-info" onclick="exportProfileCSV()">
                                    <i class="fas fa-file-csv me-1"></i>Export as CSV
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Form submission
        document.getElementById('profileForm').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('Profile updated successfully!');
        });
    });

    function previewImage(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('profileImage').src = e.target.result;
            }
            reader.readAsDataURL(input.files[0]);
            alert('Profile image updated!');
        }
    }

    function removeProfileImage() {
        if (confirm('Remove profile image?')) {
            document.getElementById('profileImage').src = "{% static 'images/default-avatar.png' %}";
            document.getElementById('uploadImage').value = '';
            alert('Profile image removed!');
        }
    }

    function resetProfileForm() {
        if (confirm('Reset all profile changes?')) {
            document.getElementById('profileForm').reset();
            document.getElementById('profileImage').src = "{% static 'images/default-avatar.png' %}";
        }
    }

    function saveProfessionalDetails() {
        alert('Professional details saved!');
    }

    function exportProfilePDF() {
        alert('Profile PDF export started. You will receive an email when it\'s ready.');
    }

    function exportProfileJSON() {
        alert('Profile JSON exported successfully!');
    }

    function exportProfileCSV() {
        alert('Profile CSV exported successfully!');
    }
</script>
{% endblock %}